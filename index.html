<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… M-TAHA Ø§Ù„Ø°ÙƒÙŠ</title>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;900&display=swap" rel="stylesheet">
<style>
body { font-family:'Cairo',sans-serif; background:#f4f7f6; margin:0; padding-bottom:90px; color:#2c3e50; }
.card { background:white; border-radius:20px; padding:20px; margin:15px; box-shadow:0 8px 20px rgba(0,0,0,0.1);}
.main-btn { width:100%; padding:14px; border:none; border-radius:12px; background:#27ae60; color:white; font-weight:bold; cursor:pointer; font-size:16px;}
#admin-banner { background:#f39c12; color:white; text-align:center; padding:10px 0; font-weight:bold; overflow:hidden; white-space:nowrap;}
#banner-text { display:inline-block; padding-left:100%; animation:marquee 15s linear infinite;}
@keyframes marquee { 0% { transform:translateX(100%);} 100% { transform:translateX(-100%);} }
</style>
</head>
<body>

<div id="admin-banner"><span id="banner-text">Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙƒÙ… ÙÙŠ Ù†Ø¸Ø§Ù… M-TAHA!</span></div>

<div id="lock-screen">
    <div class="card">
        <h2>Ù†Ø¸Ø§Ù… M-TAHA</h2>
        <input type="text" id="reg-sid" placeholder="Ù…Ø¹Ø±Ù Ø§Ù„Ù…ØªØ¬Ø±">
        <input type="text" id="reg-name" placeholder="Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ù…ØªØ¬Ø±">
        <button class="main-btn" onclick="requestActivation()">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„ ğŸ”‘</button>
    </div>
</div>

<div id="app-content" style="display:none;">
    <h3 id="display-store-name"></h3>
    <button onclick="resetApp()">âš™ï¸ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø©</button>
    <!-- Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…: Ø§Ù„Ù…Ø®Ø²Ù†ØŒ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§ØªØŒ Ø§Ù„Ø¯ÙŠÙˆÙ†ØŒ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª -->
</div>

<script>
const firebaseConfig = { databaseURL:"https://YOUR-PROJECT-ID.firebaseio.com" };
firebase.initializeApp(firebaseConfig);
const rdb = firebase.database();

let sid = localStorage.getItem('m_taha_sid');
let storeData = { p:[], s:[] };

const bannerRef = rdb.ref('admin/banner');
bannerRef.on('value', snap => {
    document.getElementById('banner-text').innerText = snap.val()||"Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙƒÙ… ÙÙŠ Ù†Ø¸Ø§Ù… M-TAHA!";
});

if(sid){
    rdb.ref('requests/'+sid).on('value', s=>{
        const d=s.val();
        if(d && d.status==='active'){
            document.getElementById('lock-screen').style.display='none';
            document.getElementById('app-content').style.display='block';
            document.getElementById('display-store-name').innerText=d.name;
        }
    });
}

function requestActivation(){
    const id=document.getElementById('reg-sid').value.trim();
    const nm=document.getElementById('reg-name').value.trim();
    if(!id||!nm)return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    rdb.ref('requests/'+id).set({name:nm,status:'pending'}).then(()=>{
        localStorage.setItem('m_taha_sid',id); location.reload();
    });
}

function resetApp(){
    if(confirm("âš ï¸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØ¬Ø±!")){
        localStorage.removeItem('m_taha_sid');
        if(sid && confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙÙŠ FirebaseØŸ")) rdb.ref('stores/'+sid).remove();
        location.reload();
    }
}
</script>
</body>
</html>
